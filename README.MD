![Logo](logo.png)
# Ubuntu Autoinstall Maker

[![Ubuntu Version](https://img.shields.io/badge/Ubuntu-24.04%20LTS-E95420?logo=ubuntu)](https://ubuntu.com)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Shell Script](https://img.shields.io/badge/Shell-Bash-4EAA25?logo=gnu-bash)](auto-install.sh)

Automated Ubuntu 24.04 Desktop installation tool with USB creation and VM testing support.

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡)

---

## English

### ğŸ“‹ Overview

A complete solution for automating Ubuntu 24.04 Desktop installation with zero user interaction. Create bootable USB drives or test installations in virtual machines using cloud-init configuration.

### âœ¨ Features

- **Zero-Touch Installation**: Fully automated with no manual intervention required
- **Dual Mode Support**: 
  - Physical USB installation with Wi-Fi support
  - Virtual machine testing with KVM/QEMU
- **Smart Network Configuration**: Auto-detects wired adapters (eth0/ens33/enp3s0), supports Wi-Fi pre-configuration
- **Minimal System**: Only essential kernel packages installed
- **Custom Optimizations**:
  - Removes Snap package manager
  - Configures passwordless sudo
  - Pre-configures Bash aliases (ll, uu, etc.)
  - Auto-creates common directories (Programs, Downloads, Temp)

### ğŸš€ Quick Start

#### Prerequisites

The script auto-detects and installs required dependencies:
- `xorriso` - ISO image processing
- `cloud-image-utils` - Cloud-init utilities
- `virt-install` - Virtual machine management
- `dosfstools` - FAT32 filesystem tools

#### Initial Setup

1. **Clone the repository**
```bash
git clone https://github.com/yourusername/ubuntu-autoinstall-maker.git
cd ubuntu-autoinstall-maker
```

2. **Download Ubuntu 24.04 ISO**
```bash
wget https://releases.ubuntu.com/24.04/ubuntu-24.04-desktop-amd64.iso
```

3. **Create configuration files from samples**
```bash
cp user-data.sample user-data
cp network-config.sample network-config
```

4. **Customize your settings** (see [Configuration](#configuration))

#### Usage

**Option 1: Create USB Installer**
```bash
chmod +x auto-install.sh
sudo ./auto-install.sh
# Select option 1
```

**Option 2: Test in Virtual Machine** (Recommended first)
```bash
sudo ./auto-install.sh
# Select option 2
```

Monitor VM installation:
```bash
virsh list --all
virt-viewer ubuntu-autoinstall-XXXXXX
```

### âš™ï¸ Configuration

#### Generate Encrypted Password

```bash
# Using mkpasswd (recommended)
mkpasswd -m sha-512 your_password

# Or using openssl
openssl passwd -6 your_password
```

#### Edit `user-data`

```yaml
identity:
  hostname: your-hostname          # Set your hostname
  username: your-username          # Set your username
  password: "$6$..."               # Paste encrypted password

locale: en_US.UTF-8                # Language setting
timezone: America/Vancouver        # Your timezone

packages:                          # Additional packages
  - git
  - curl
  - vim
```

#### Edit `network-config` (for Wi-Fi)

```yaml
wifis:
  wlan0:
    access-points:
      "YourWiFiName":               # Your Wi-Fi SSID
        password: "YourPassword"    # Your Wi-Fi password
```

### ğŸ“ Project Structure

```
ubuntu-autoinstall-maker/
â”œâ”€â”€ auto-install.sh           # Main control script
â”œâ”€â”€ user-data.sample          # Sample autoinstall configuration
â”œâ”€â”€ network-config.sample     # Sample network configuration
â”œâ”€â”€ meta-data                 # Instance metadata
â”œâ”€â”€ README.md                 # This file
â””â”€â”€ ubuntu-*.iso              # Ubuntu ISO (download separately)
```

### âš ï¸ Important Notes

#### 1. Virtual Machine Firmware Settings

When manually creating VMs in Virtual Machine Manager (virt-manager):

1. At the final step, **check** `Customize configuration before install`
2. Select **Overview** in the left panel
3. Under **Firmware**, choose:
   ```
   UEFI x86_64: /usr/share/OVMF/OVMF_CODE_4M.fd
   ```
4. **Avoid** firmware versions containing `secboot` or `ms`
5. Click **Apply**, then **Begin Installation**

**Reason**: Secure Boot may cause autoinstall failures.

#### 2. Network Configuration Differences

**Virtual Machines**:
- No Wi-Fi adapters available
- Network interfaces typically named `ens3`, `ens4`, etc.
- Default `user-data` auto-matches any interface starting with `e`

**Physical USB Installation**:
- Wi-Fi configuration fully supported
- Script automatically deploys Wi-Fi settings from `network-config`
- Can use both wired and wireless simultaneously

### ğŸ” Troubleshooting

**VM Won't Start**
```bash
# Check KVM support
egrep -c '(vmx|svm)' /proc/cpuinfo  # Should be > 0

# Check virtualization service
sudo systemctl status libvirtd
```

**USB Boot Failure**
1. Enable UEFI boot in BIOS/UEFI
2. Disable Secure Boot if necessary
3. Set USB device as first boot priority

**Network Config Not Applied**
- Use 2-space indentation (not tabs)
- YAML syntax requires space after colons
- Quote Wi-Fi passwords

### ğŸ“‹ System Requirements

**Target Machine**:
- Minimum: 2GB RAM, 15GB disk
- Recommended: 4GB RAM, 25GB disk
- Network: Wired or supported wireless adapter

**Build Environment**:
- Ubuntu/Debian system
- Root privileges
- 8GB+ USB device (for USB creation)

### ğŸ›¡ï¸ Security Recommendations

1. Use strong passwords and secure encrypted credentials
2. Always test in VM before physical deployment
3. Backup data - USB/installation will erase target device
4. Review security settings in `user-data` before deployment

### ğŸ“š Resources

- [Ubuntu Autoinstall Documentation](https://ubuntu.com/server/docs/install/autoinstall)
- [Cloud-init Reference](https://cloudinit.readthedocs.io/)
- [Netplan Configuration](https://netplan.io/reference/)

### ğŸ“„ License

MIT License - See [LICENSE](LICENSE) file for details.

---

## ä¸­æ–‡

### ğŸ“‹ æ¦‚è¿°

Ubuntu 24.04 æ¡Œé¢ç‰ˆæ— äººå€¼å®ˆå®‰è£…å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒ USB å®‰è£…ç›˜åˆ¶ä½œå’Œè™šæ‹Ÿæœºæµ‹è¯•ã€‚

### âœ¨ åŠŸèƒ½ç‰¹æ€§

- **é›¶äº¤äº’å®‰è£…**ï¼šå®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
- **åŒæ¨¡å¼æ”¯æŒ**ï¼š
  - USB ç‰©ç†å®‰è£…ï¼ˆæ”¯æŒ Wi-Fiï¼‰
  - è™šæ‹Ÿæœºæµ‹è¯•ï¼ˆKVM/QEMUï¼‰
- **æ™ºèƒ½ç½‘ç»œé…ç½®**ï¼šè‡ªåŠ¨é€‚é…æœ‰çº¿ç½‘å¡ï¼ˆeth0/ens33/enp3s0 ç­‰ï¼‰ï¼Œæ”¯æŒ Wi-Fi é¢„é…ç½®
- **æœ€å°åŒ–ç³»ç»Ÿ**ï¼šåªå®‰è£…æœ€åŸºæœ¬çš„å†…æ ¸
- **è‡ªå®šä¹‰ä¼˜åŒ–**ï¼š
  - ç§»é™¤ Snap è½¯ä»¶åŒ…ç®¡ç†å™¨
  - é…ç½® sudo å…å¯†ç 
  - é¢„è®¾ Bash åˆ«åï¼ˆllã€uu ç­‰ï¼‰
  - è‡ªåŠ¨åˆ›å»ºå¸¸ç”¨ç›®å½•ï¼ˆProgramsã€Downloadsã€Tempï¼‰

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### å‰ç½®è¦æ±‚

è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…æ‰€éœ€ä¾èµ–ï¼š
- `xorriso` - ISO é•œåƒå¤„ç†
- `cloud-image-utils` - Cloud-init å·¥å…·
- `virt-install` - è™šæ‹Ÿæœºç®¡ç†
- `dosfstools` - FAT32 æ–‡ä»¶ç³»ç»Ÿå·¥å…·

#### åˆå§‹è®¾ç½®

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/yourusername/ubuntu-autoinstall-maker.git
cd ubuntu-autoinstall-maker
```

2. **ä¸‹è½½ Ubuntu 24.04 ISO**
```bash
wget https://releases.ubuntu.com/24.04/ubuntu-24.04-desktop-amd64.iso
```

3. **ä»ç¤ºä¾‹æ–‡ä»¶åˆ›å»ºé…ç½®**
```bash
cp user-data.sample user-data
cp network-config.sample network-config
```

4. **è‡ªå®šä¹‰é…ç½®**ï¼ˆå‚è§[é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)ï¼‰

#### ä½¿ç”¨æ–¹æ³•

**æ–¹å¼ 1ï¼šåˆ¶ä½œ USB å®‰è£…ç›˜**
```bash
chmod +x auto-install.sh
sudo ./auto-install.sh
# é€‰æ‹©é€‰é¡¹ 1
```

**æ–¹å¼ 2ï¼šè™šæ‹Ÿæœºæµ‹è¯•**ï¼ˆæ¨èå…ˆæµ‹è¯•ï¼‰
```bash
sudo ./auto-install.sh
# é€‰æ‹©é€‰é¡¹ 2
```

ç›‘æ§è™šæ‹Ÿæœºå®‰è£…ï¼š
```bash
virsh list --all
virt-viewer ubuntu-autoinstall-XXXXXX
```

### âš™ï¸ é…ç½®è¯´æ˜

#### ç”ŸæˆåŠ å¯†å¯†ç 

```bash
# ä½¿ç”¨ mkpasswdï¼ˆæ¨èï¼‰
mkpasswd -m sha-512 your_password

# æˆ–ä½¿ç”¨ openssl
openssl passwd -6 your_password
```

#### ç¼–è¾‘ `user-data`

```yaml
identity:
  hostname: your-hostname          # è®¾ç½®ä¸»æœºå
  username: your-username          # è®¾ç½®ç”¨æˆ·å
  password: "$6$..."               # ç²˜è´´åŠ å¯†å¯†ç 

locale: en_US.UTF-8                # è¯­è¨€è®¾ç½®
timezone: America/Vancouver        # æ—¶åŒºè®¾ç½®

packages:                          # é¢å¤–å®‰è£…çš„è½¯ä»¶åŒ…
  - git
  - curl
  - vim
```

#### ç¼–è¾‘ `network-config`ï¼ˆWi-Fi é…ç½®ï¼‰

```yaml
wifis:
  wlan0:
    access-points:
      "ä½ çš„WiFiåç§°":                # Wi-Fi SSID
        password: "ä½ çš„WiFiå¯†ç "     # Wi-Fi å¯†ç 
```

### ğŸ“ é¡¹ç›®ç»“æ„

```
ubuntu-autoinstall-maker/
â”œâ”€â”€ auto-install.sh           # ä¸»æ§è„šæœ¬
â”œâ”€â”€ user-data.sample          # è‡ªåŠ¨å®‰è£…é…ç½®ç¤ºä¾‹
â”œâ”€â”€ network-config.sample     # ç½‘ç»œé…ç½®ç¤ºä¾‹
â”œâ”€â”€ meta-data                 # å®ä¾‹å…ƒæ•°æ®
â”œâ”€â”€ README.md                 # æœ¬æ–‡ä»¶
â””â”€â”€ ubuntu-*.iso              # Ubuntu ISOï¼ˆéœ€å•ç‹¬ä¸‹è½½ï¼‰
```

### âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

#### 1. è™šæ‹Ÿæœºå›ºä»¶è®¾ç½®

ä½¿ç”¨ Virtual Machine Manager (virt-manager) æ‰‹åŠ¨åˆ›å»ºè™šæ‹Ÿæœºæ—¶ï¼š

1. åœ¨æœ€åä¸€æ­¥ï¼Œ**å‹¾é€‰** `Customize configuration before install`
2. åœ¨å·¦ä¾§é¢æ¿é€‰æ‹© **Overview**
3. åœ¨ **Firmware** ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ï¼š
   ```
   UEFI x86_64: /usr/share/OVMF/OVMF_CODE_4M.fd
   ```
4. **ä¸è¦é€‰æ‹©**åŒ…å« `secboot` æˆ– `ms` å­—æ ·çš„å›ºä»¶ç‰ˆæœ¬
5. ç‚¹å‡» **Apply**ï¼Œç„¶åç‚¹å‡» **Begin Installation**

**åŸå› **ï¼šå®‰å…¨å¯åŠ¨ï¼ˆSecure Bootï¼‰å¯èƒ½å¯¼è‡´æ— äººå€¼å®ˆå®‰è£…å¤±è´¥ã€‚

#### 2. ç½‘ç»œé…ç½®å·®å¼‚

**è™šæ‹Ÿæœºç¯å¢ƒ**ï¼š
- æ²¡æœ‰ Wi-Fi ç½‘å¡
- ç½‘å¡åç§°é€šå¸¸ä¸º `ens3`ã€`ens4` ç­‰
- é»˜è®¤ `user-data` å·²é’ˆå¯¹è™šæ‹Ÿæœºä¼˜åŒ–ï¼ˆè‡ªåŠ¨åŒ¹é…ä»¥ `e` å¼€å¤´çš„ç½‘å¡ï¼‰

**ç‰©ç†æœº USB å®‰è£…**ï¼š
- æ”¯æŒ Wi-Fi ç½‘å¡é…ç½®
- è„šæœ¬è‡ªåŠ¨å°† `network-config` ä¸­çš„ Wi-Fi é…ç½®éƒ¨ç½²åˆ°å®‰è£…ç›˜
- å¯åŒæ—¶ä½¿ç”¨æœ‰çº¿å’Œæ— çº¿ç½‘ç»œ

### ğŸ” æ•…éšœæ’æŸ¥

**è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨**
```bash
# æ£€æŸ¥ KVM æ”¯æŒ
egrep -c '(vmx|svm)' /proc/cpuinfo  # åº”å¤§äº 0

# æ£€æŸ¥è™šæ‹ŸåŒ–æœåŠ¡
sudo systemctl status libvirtd
```

**USB å¯åŠ¨å¤±è´¥**
1. åœ¨ BIOS/UEFI ä¸­å¯ç”¨ UEFI å¯åŠ¨
2. å¿…è¦æ—¶ç¦ç”¨ Secure Boot
3. å°† USB è®¾å¤‡è®¾ä¸ºç¬¬ä¸€å¯åŠ¨é¡¹

**ç½‘ç»œé…ç½®æœªç”Ÿæ•ˆ**
- ä½¿ç”¨ 2 ç©ºæ ¼ç¼©è¿›ï¼ˆä¸æ˜¯ Tabï¼‰
- YAML è¯­æ³•ï¼šå†’å·åå¿…é¡»æœ‰ç©ºæ ¼
- Wi-Fi å¯†ç éœ€ç”¨å¼•å·åŒ…è£¹

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

**ç›®æ ‡æœºå™¨**ï¼š
- æœ€ä½ï¼š2GB RAMã€15GB ç¡¬ç›˜
- æ¨èï¼š4GB RAMã€25GB ç¡¬ç›˜
- ç½‘ç»œï¼šæœ‰çº¿ç½‘å¡æˆ–æ”¯æŒçš„æ— çº¿ç½‘å¡

**åˆ¶ä½œç¯å¢ƒ**ï¼š
- Ubuntu/Debian ç³»ç»Ÿ
- Root æƒé™
- 8GB+ USB è®¾å¤‡ï¼ˆåˆ¶ä½œå®‰è£…ç›˜æ—¶ï¼‰

### ğŸ›¡ï¸ å®‰å…¨å»ºè®®

1. ä½¿ç”¨å¼ºå¯†ç å¹¶å¦¥å–„ä¿ç®¡åŠ å¯†å¯†æ–‡
2. å®é™…éƒ¨ç½²å‰åŠ¡å¿…åœ¨è™šæ‹Ÿæœºä¸­æµ‹è¯•
3. å¤‡ä»½æ•°æ® - USB åˆ¶ä½œå’Œå®‰è£…ä¼šæ¸…ç©ºç›®æ ‡è®¾å¤‡
4. æ ¹æ®å®é™…éœ€æ±‚å®¡æŸ¥ `user-data` ä¸­çš„å®‰å…¨è®¾ç½®

### ğŸ“š æ‰©å±•èµ„æº

- [Ubuntu Autoinstall å®˜æ–¹æ–‡æ¡£](https://ubuntu.com/server/docs/install/autoinstall)
- [Cloud-init é…ç½®å‚è€ƒ](https://cloudinit.readthedocs.io/)
- [Netplan ç½‘ç»œé…ç½®](https://netplan.io/reference/)

### ğŸ“„ è®¸å¯è¯

MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

**æç¤º**ï¼šé¦–æ¬¡ä½¿ç”¨å»ºè®®å…ˆåœ¨è™šæ‹Ÿæœºä¸­æµ‹è¯•å®Œæ•´æµç¨‹ï¼Œç¡®è®¤é…ç½®æ­£ç¡®åå†åˆ¶ä½œç‰©ç† USB å®‰è£…ç›˜ã€‚
